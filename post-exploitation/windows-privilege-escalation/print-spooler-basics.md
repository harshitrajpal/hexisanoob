# Print Spooler Basics

### Background

Print spooler is abuilt in exe that is the primary interface of the printing process. It manages the printing process. It is loaded at the system startup and runs till it is shut down.

![](<../../.gitbook/assets/image (99).png>)

Application: The print application creates a print job by calling Graphics Device Interface (GDI).

GDI: GDI includes both user-mode and kernel-mode components for graphics support.

winspool.drv is the interface that talks to spooler. It provides the RPC stubs required to accessing the server.

spoolsv.exe is the spooler's API server. This module implements message routing to print provider with the help of router (spoolss.dll)

spoolss.dll determines which print provider to call, base don a printer name and passes function call ot the correct provider.

#### Print Provider

When a user prints a document, a print job is spooled to a predefined location referred to as the “spool directory”. The spool directory is configurable on each printer and it must allow the [`FILE_ADD_FILE`](https://docs.microsoft.com/en-us/windows/win32/fileio/file-access-rights-constants) permission to all users.

![](<../../.gitbook/assets/image (87).png>)

